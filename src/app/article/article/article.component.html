<div style="height: 50px;"></div>
<div class="container-md">
    <div class="row bg-info bg-opacity-25 p-4 shadow">
        <div class="col">

            <!-- ARTICLE -->
            <div class="d-flex justify-content-between">
                <h3>{{ showArticle.title }}</h3>
                <div class="d-flex">
                    <fa-icon *ngIf="!showArticle.isFavourite" class="mx-2" (click)="toggleFavorite(showArticle.slug, showArticle.isFavourite)" [icon]="faStar"></fa-icon>
                    <fa-icon *ngIf="showArticle.isFavourite" class="mx-2 star-icon-full" (click)="toggleFavorite(showArticle.slug, showArticle.isFavourite)" [icon]="solidFaStar"></fa-icon>
                    <button  (click)="editArticle(showArticle.slug!)" class="btn btn-outline-warning btn ms-3">Edit</button>
                </div>
            </div>
                <p class="text-muted">
                    {{ showArticle.description }}
                </p>
                <div>
                    <span *ngFor="let tag of showArticle.tagList" class="badge rounded-pill bg-secondary me-2">{{ tag
                        }}</span>
                </div>
                <hr>
                <p>{{ showArticle.body }}</p>
            <hr>


            <div *ngIf="!loggedIn" class="alert alert-light" role="alert">
                Log in to leave a comment!
            </div>
            <hr *ngIf="!loggedIn">

            <!-- LEAVE COMMENT -->
            <div *ngIf="loggedIn">
                <h5 class="mt-5">What do you think about it?</h5>
                <form action="" #comment="ngForm" (ngSubmit)="submitComment(comment)">
                    <textarea class="form-control" name="body" id="body" rows="2" ngModel required></textarea>
                    <div class="d-flex flex-row-reverse">
                        <button class="btn btn-success my-3" [disabled]="comment.form.invalid">Send</button>
                    </div>
                </form>
            </div>

        </div>
    </div>
    <div class="row bg-info bg-opacity-10 p-4 shadow">
        <div class="col">

            <!-- COMMENTS -->
            <div class="d-flex flex-row justify-content-start align-items-center">
                <h5 class="mt-3">Comments</h5>
                <fa-icon (click)="showEditComment()" class="mt-3 px-2 article-icon" [icon]="faPenSquare"></fa-icon>
            </div>
            <div class="container">
                <div *ngFor="let comment of showArticle.comments" class="row my-3">
                    <div class="col">
                        <p (click)="showUser(comment.author.username)" data-bs-toggle="modal" data-bs-target="#userProfileModal" class="mb-0 fw-bold lh-1 user_link">{{ comment.author.username }}</p>
                        <small class="text-muted lh-1">{{ comment.created | date:'y. MMMM d. EEEE HH:mm'}}</small>
                        <p class="lh-1">{{ comment.body }}</p>
                    </div>
                    <div *ngIf="editOn" class="col-1">
                        <fa-icon (click)="deleteComment(comment.id)" class="mt-3 me-2 article-icon-red"
                            [icon]="faTrash"></fa-icon>
                    </div>
                    <hr>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- POPUP MODAL ON USER CLICK, SHOWS USER PROFILE. CAN FOLLOW IF LOGGED IN -->
<div class="modal fade" id="userProfileModal" tabindex="-1" aria-labelledby="userProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userProfileModalLabel">User Info</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row my-1"><div class="col-3">Username:</div><div class="col-9">{{ pickedUserProfile.username }}</div></div>
                    <div class="row my-1"><div class="col-3">Biograph:</div><div class="col-9">{{ pickedUserProfile.bio }}</div></div>
                    <div class="row my-1"><div class="col-3">Image:</div><div class="col-9">{{ pickedUserProfile.image }}</div></div>
                </div>
            </div>
            <div class="modal-footer">
                <button *ngIf="loggedIn && !pickedUserProfile.following" (click)="followUser(pickedUserProfile.username)" type="button" class="btn btn-primary">Follow</button>
                <button *ngIf="loggedIn && pickedUserProfile.following" (click)="unfollowUser(pickedUserProfile.username)" type="button" class="btn btn-primary">UnFollow</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>